(this["webpackJsonpbeat-the-market"]=this["webpackJsonpbeat-the-market"]||[]).push([[0],{132:function(e,t,a){},172:function(e,t,a){e.exports=a(359)},177:function(e,t,a){},359:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(50),o=a.n(c),i=(a(177),a(143)),l=a(81),u=a(10),s=a(36),m=a.n(s),p=a(78);function f(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=[],r=t,c=0;c<e;c++)(r+=a*(Math.random()-.5))<0&&(r=0),n.push(r);return n}function d(e){return h.apply(this,arguments)}function h(){return(h=Object(p.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/beat-the-market/"+t,e.next=3,fetch(a).then((function(e){return e.text()}));case 3:return n=e.sent,e.prev=4,e.abrupt("return",JSON.parse(n));case 8:throw e.prev=8,e.t0=e.catch(4),Error("Wrong data at ".concat(a,": ").concat(e.t0.message," \n ").concat(n));case 11:case"end":return e.stop()}}),e,null,[[4,8]])})))).apply(this,arguments)}function y(){return(y=Object(p.a)(m.a.mark((function e(t){var a,n,r,c,o,i,l,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d("pairs.json");case 3:return a=e.sent,console.log("Pairs",a),n=a[Math.floor(Math.random()*a.length)],e.next=8,d(n);case 8:return r=e.sent,console.log("Received prices",r),c=r.length-t,o=Math.round(c*Math.random()),i=r.slice(o,o+t).map((function(e,t){var a=Object(u.a)(e,2),n=a[0],r=a[1];return{i:t,price:parseFloat(r),time:n}})),l=n.replace(".json","").replace("price/","").replace("USD",""),e.abrupt("return",{data:i,pair:l});case 17:return e.prev=17,e.t0=e.catch(0),console.error("Error fetching price data: ".concat(e.t0.message)),s=f(t,20,5).map((function(e,t){return{i:t,price:Math.round(100*e)/100,time:"day ".concat(t)}})),e.abrupt("return",{data:s,pair:"RND"});case 22:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}var E=a(8);a(132);function b(e){var t=e.data,a=e.parsedPositions,n=e.yMax,c=e.hasFinished,o={stroke:"gray",strokeDasharray:"3 3"},i={stroke:"#414141",fill:"white",fillOpacity:.1},l={name:"time",dy:10,stroke:"white",interval:"preserveStartEnd"};function u(e){var t=e.textAnchor,a=e.viewBox,n=e.text;return r.a.createElement("text",{x:a.x-25,y:a.y+15,fill:"white",textAnchor:t},n)}return r.a.createElement(E.g,null,r.a.createElement(E.c,null,c?r.a.createElement(E.h,Object.assign({dataKey:"time",domain:["auto","auto"],minTickGap:50,tickFormatter:function(e){return new Date(e).toDateString().split(" ").slice(1).join(" ")}},l)):r.a.createElement(E.h,Object.assign({dataKey:"i",type:"number",domain:["auto",n],tickFormatter:function(e){return"day ".concat(e)}},l)),r.a.createElement(E.i,{dataKey:"price",type:"number",name:"price",unit:" $",domain:["auto","auto"],stroke:"white",hide:!c}),r.a.createElement(E.a,{strokeDasharray:"3 3",stroke:"#292929"}),a.map((function(e,t){var a=e.xFrom,n=e.xTo,c=e.yFrom,o=e.yTo,i=e.isWin;return r.a.createElement(E.d,{key:"position-area-".concat(t),x1:a,x2:n,y1:c,y2:o,fill:i?"green":"red",stroke:"gray",strokeOpacity:.3,fillOpacity:.4})})),a.map((function(e,t){var a=e.xFrom;return r.a.createElement(E.f,Object.assign({key:"buyline".concat(t),x:a},o))})),a.map((function(e,t){var a=e.xTo;return e.isOpen?null:r.a.createElement(E.f,Object.assign({key:"sellline".concat(t),x:a},o))})),a.map((function(e,t){var a=e.xFrom,n=e.yFrom;return r.a.createElement(E.e,Object.assign({key:"buydot".concat(t),label:r.a.createElement(u,{text:"Buy"}),x:a,y:n},i))})),a.map((function(e,t){var a=e.xTo,n=e.yTo;return e.isOpen?null:r.a.createElement(E.e,Object.assign({key:"selldot".concat(t),label:r.a.createElement(u,{text:"Sell"}),x:a,y:n},i))})),r.a.createElement(E.b,{isAnimationActive:!1,data:t,type:"monotone",dataKey:"price",stroke:"red",strokeWidth:2,strokeOpacity:1,dot:!1})))}var v=a(142),k=200;function O(){var e=Object(n.useState)(!1),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(u.a)(o,2),m=s[0],p=s[1],f=Object(n.useState)(30),d=Object(u.a)(f,2),h=d[0],E=d[1],O=Object(n.useState)([]),g=Object(u.a)(O,2),j=g[0],x=g[1],S=Object(n.useState)(""),w=Object(u.a)(S,2),F=w[0],M=w[1],T=Object(n.useState)(!1),N=Object(u.a)(T,2),C=N[0],D=N[1],A=Object(n.useState)(0),B=Object(u.a)(A,2),K=B[0],P=B[1],W=h<k,J=h>=k,R=30===h;function I(){if(!J&&0!==j.length){var e=m[m.length-1];e&&"undefined"===typeof e.to?e.from!==h&&p([].concat(Object(l.a)(m.slice(0,m.length-1)),[Object(i.a)({},e,{to:h})])):p([].concat(Object(l.a)(m),[{from:h}]))}}function U(){a||c(!0),I()}Object(n.useEffect)((function(){var e=setTimeout((function(){W&&a&&j.length>0&&E((function(e){return e+1}))}),150);return function(){clearInterval(e)}}),[h,a]),Object(n.useEffect)((function(){D(!0),function(e){return y.apply(this,arguments)}(201).then((function(e){var t=e.data,a=e.pair;x(t),M(a)})).catch((function(e){return console.error("Error fetching price data: ".concat(e.message))})).then((function(){D(!1)}))}),[K]),Object(n.useEffect)((function(){document.body.onkeyup=function(e){32===e.keyCode&&(console.log("SPACE!"),I()),13===e.keyCode&&c((function(e){return!e}))}}));var G=m.map((function(e){var t=e.from,a=e.to,n=t,r=a?Math.min(a,h):h,c=J?(j[n]||{}).time:n,o=J?(j[r]||{}).time:r,i=(j[n]||{}).price,l=(j[r]||{}).price;return{iFrom:n,iTo:r,xFrom:c,xTo:o,yFrom:i,yTo:l,isWin:l>i,isOpen:!a}})),Y=j.length?(j[h].price-j[0].price)/j[0].price:0,$=G.reduce((function(e,t){var a=t.yFrom;return e*(t.yTo/a)}),1)-1;return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,r.a.createElement("strong",null,"Beat")," the market"),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Market"),r.a.createElement("th",null,"You")),r.a.createElement("tr",null,r.a.createElement("td",null,Math.round(100*Y),"%"),r.a.createElement("td",null,Math.round(100*$),"%"))))),R&&r.a.createElement("div",{className:"instructions",onClick:U},r.a.createElement("div",null,"Click anywhere ",r.a.createElement("br",null),r.a.createElement("strong",null,"to start")),r.a.createElement("div",{className:"help"},"Click again to buy / sell")),J&&r.a.createElement("div",{className:"restart",onClick:function(){D(!1),p([]),c(!1),E(30),P((function(e){return e+1}))}},r.a.createElement("big",null,"Restart"),r.a.createElement("small",null,r.a.createElement(v.a,null))),J&&r.a.createElement("div",{className:"market-name"},r.a.createElement("big",null,F," USD"),r.a.createElement("small",null,F)),r.a.createElement("div",{className:"price-chart-container ".concat(C?"loading":""),onClick:U},r.a.createElement(b,{data:j.slice(0,h+1),parsedPositions:G,yMax:k,hasFinished:J})))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.a4bd6b9f.chunk.js.map